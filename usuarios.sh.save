
#!/bin/bash
# usuarios.sh
#
# Mostra o login e nomes de usuários no sistema
# Obs: Lê os dados do arquivo /etc/passwd
#
# Versão 1.0: Mostra usuários e nomes separados por TAB
# Versão 1.2: Adicionando suporte à opção -h e -V
# Versão 1.3: Ajustando para o correr o processamento caso não tenha argumentos
# Versão 1.4: Informar a ultima versão automaticamente

# Rafael, abril de 2020
#

MENSAGEM_USO="
	Uso: $(basename "$0") [-h|-V]

	-h	Monstra tela de ajuda e sai
	-V	Mostra a versão do programa e sai
"


ordenar=0	# A sa$'ída deverá ser ordenada?

#Tratamento das opções da linha de comando
case "$1" in
	-h|--help) 
		echo "$MENSAGEM_USO"
		exit 0
	;;
	-V|--version)
		echo -n $(basename "$0")
		# Extrai a versão diretamente do cabeçalho
		grep '^# Versão ' "$0" | tail -1 | cut -d : -f 1 | tr -d \# 
		exit 0
	;;
	-s | --sort)
		ordenar=1
	;;
	*)
	if test -n "$1"
		then
			echo "Opção inválida: Digite -h para informações"
			exit 1
		fi
	;;
esac

# Extrai a listagem
lista =$(cut -d : -f 1,5 /etc/passwd)

# Ordena (se necessário)
if test "$ordenar"=1
then
	lista=$(echo "$lista" | sort)
fi

# Mostra o resultado ao usuário
echo "$lista" | tr : //t

